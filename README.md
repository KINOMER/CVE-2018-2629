# CVE-2018-2628漏洞批量检测脚本

#### 使用方法
IP格式：
```python
192.168.31.1:443
192.168.31.100:443
```
* 命名为url.txt保存在同目录下执行脚本即可。
* 输出效果请自己注释！

#### 更新：weblogic_poc-cve-2018-2628-update.py
* 1、把测试的IP添加到列表，最后输出。
* 2、凑合着用吧
* 3、自定义无漏洞网站的检测超时时间(不设置会一直循环)：（timeout = 0单位秒）
```python
if __name__=="__main__":
    timeout = 0
    run(0)
```


### weblogic_poc-cve-2018-2628.py
#### 须知
本脚本为绿盟出品，但一次只能检测一个网站，而且每次都要编辑代码...
所以我给她加了个批量检测的轮子，让她跑得更远。
多次测试，不存在漏洞的网站，接收的载荷请求长度为0，所以直接通过长度判断漏洞是否存在。因为不这么做，程序会一直卡住。或者自己设置payload执行超时时间。

### 漏洞描述
北京时间4月18日凌晨，Oracle官方发布了4月份的关键补丁更新CPU（Critical Patch Update）,其中包含一个高危的Weblogic反序列化漏洞(CVE-2018-2628)，通过该漏洞，攻击者可以在未授权的情况下远程执行代码。
漏洞影响范围
```python
Weblogic 10.3.6.0
Weblogic 12.1.3.0
Weblogic 12.2.1.2
Weblogic 12.2.1.3
```
以上均为官方支持的版本。


### 解决方案
Oracle官方已经在今天的关键补丁更新（CPU）中修复了该漏洞，强烈建议受影响的用户尽快升级更新补丁进行防护。

补丁连接：http://www.oracle.com/technetwork/security-advisory/cpujan2017-2881727.html

临时措施请穿越：http://blog.nsfocus.net/cve-2018-2628-solution/
